# 酒店搜索引擎需求分析与记录

## 一、项目基本信息

### 1.1 数据量级确认
- **当前数据量**：360万酒店（国内210W + 国际150W）
- **扩展目标**：支撑1000万酒店规模
- **并发要求**：1000用户并发
- **搜索负载**：日均5万搜索请求（峰值预估500 QPS）
- **团队配置**：全栈架构师1人 + 运维1人
- **开发周期**：1.5个月
- **云服务商**：限定阿里云
- **搜索引擎**：限定Elasticsearch

## 二、数据源要求与规范

### 2.1 国内酒店数据
- **来源**：专用国内供应商接口
- **ID特征**：酒店ID > 20,000,000
- **地区限制**：明确排除港澳台地区
- **数据质量**：较完整，可直接用于搜索

### 2.2 国际酒店数据
- **来源**：爬取其他网站(如Trip.com等)
- **数据状态**：结构不完整，需要清洗整理
- **地区范围**：包含港澳台地区(需与国内数据区分处理)
- **数据质量**：参差不齐，需加强清洗

### 2.3 城市编号规范
- **国内城市**：格式为 "e" + 原编号 (如 e123)
- **国际城市**：使用原纯数字编号
- **城市表合并**：大陆城市 + 国际城市(含港澳台，但排除国内已有的CN城市)

### 2.4 基础数据表
- **参考表**：`standardcountry` 和 `standardcity`
- **数据验证**：需验证并优化这些表的数据准确性
- **国际数据**：需从原始爬取结果中重新分析整理

## 三、搜索功能需求

### 3.1 核心搜索字段（必须支持）
- **国家**：使用ISO 3166-1 alpha-2标准编码（如CN、US）
- **城市**：含城市编号规则
- **景点**：支持景点名称搜索
- **酒店类型**：商务、度假、精品等
- **酒店设施**：WiFi、游泳池、健身房等
- **星级**：支持3.5星、4星等精确搜索
- **酒店名称**：中英文名称搜索

### 3.2 不需关注字段
- **房型信息**：预订功能才需要，搜索阶段不涉及

### 3.3 输入处理要求
- **中英文混合搜索**：支持"北京 hotel"这样的混合输入
- **拼音搜索**："beijing"能搜到"北京"
- **模糊匹配**：支持拼写错误纠正
- **智能提示**：输入过程中的自动补全

### 3.4 结果展示要求
- **优先级排序**：热门城市/景点优先显示
- **多条件筛选**：支持星级、价格、设施等组合筛选
- **相关度排序**：结果按搜索相关度智能排序
- **分页支持**：支持分页和数量控制

## 四、分词和搜索特殊要求

### 4.1 分词器定制需求
- **标准分词器不足**：通用开源分词库无法满足酒店领域特殊需求
- **定制要求**：需开发酒店专有分词器

### 4.2 特殊词库处理
- **酒店专有名词**：如"香格里拉"、"四季"等品牌词
- **景点名称**：各地标志性景点的多种叫法
- **地名别名**：如"帝都"=北京、"魔都"=上海
- **国际品牌**：酒店品牌中英文对照
- **拼音映射**：如"xi"映射到"西"、"习"等相关词汇

## 五、语言支持范围

### 5.1 初始阶段（重点支持）
- **中文简体**：主要用户群体
- **中文繁体**：港澳台地区支持
- **英文**：国际化基础支持

### 5.2 后续扩展语言
- **日文**：日本市场
- **韩文**：韩国市场  
- **泰语**：泰国旅游热点
- **越南语**：越南市场

## 六、AI知识库建设需求（扩展功能）

### 6.1 知识库功能模块
- **多语言搜索**：语言识别、跨语言索引与查询
- **知识图谱**：构建酒店、城市、景点关系图谱
- **推荐算法**：基于用户行为和历史的智能推荐
- **意图识别**：理解用户搜索意图
- **热点发现**：趋势分析和预测

### 6.2 应用场景
- **智能推荐**：根据用户行为/历史推荐酒店
- **搜索纠错**："北亰" → "北京"
- **语义理解**："适合带小孩住的酒店" → 家庭友好型酒店
- **热点分析**：预测下一个热门目的地
- **意图识别**：识别用户是搜索商务酒店还是度假酒店

### 6.3 知识库内容
- **专业知识**：酒店领域专业术语和概念
- **用户行为**：搜索习惯和行为数据分析
- **地理知识**：旅游和地理知识图谱
- **标签体系**：酒店特色标签分类体系

## 七、功能优先级规划

### 7.1 Phase 1（必须实现 - 1.5个月内）
- **基础搜索功能**：酒店名称、城市、品牌搜索
- **中英文支持**：中英文混合搜索
- **拼音搜索**：支持拼音输入搜索中文
- **分词器定制**：针对酒店领域的专用分词
- **数据清洗**：360万酒店数据的清洗整理
- **索引设计**：Elasticsearch索引结构设计
- **API设计**：RESTful API接口设计

### 7.2 Phase 2（优化改进 - 后续版本）
- **AI知识库**：实现基础版本后逐步集成
- **智能推荐**：用户行为分析和推荐算法
- **搜索优化**：搜索结果排序和相关性优化
- **性能监控**：完善监控体系和性能优化

### 7.3 Phase 3（扩展功能 - 长期规划）
- **多语言扩展**：支持日文、韩文、泰语、越南语等
- **个性化推荐**：深度学习推荐算法
- **高级分析**：用户行为深度分析
- **国际化部署**：多区域部署和本地化

## 八、质量要求与约束

### 8.1 性能要求
- **响应时间**：搜索平均响应时间 < 500ms
- **并发支持**：支持1000用户同时在线
- **可用性**：系统可用性 ≥ 99%
- **准确性**：搜索结果相关性和准确性

### 8.2 数据质量要求
- **完整性**：关键字段不能缺失
- **一致性**：多语言字段保持一致
- **准确性**：地理位置、星级等信息准确
- **时效性**：数据更新及时性要求

### 8.3 用户体验要求
- **搜索体验**：快速响应，结果相关
- **界面友好**：简洁直观的搜索界面
- **多终端支持**：Web和移动端适配
- **国际化**：多语言界面支持

## 九、实施注意事项

### 9.1 关键成功因素
- **数据清洗质量**：数据清洗转换是引擎质量的关键
- **分词器效果**：定制分词器的准确性直接影响搜索体验
- **搜索相关性**：搜索结果的相关性和排序算法
- **系统稳定性**：高并发下的系统稳定性保障

### 9.2 风险控制
- **数据源风险**：国际数据爬取的法律和技术风险
- **技术风险**：ES集群稳定性和性能风险
- **进度风险**：开发周期紧张的进度控制
- **质量风险**：搜索准确性和用户体验风险

### 9.3 监控重点
- **搜索响应时间**：实时监控搜索性能
- **错误率监控**：系统错误和异常监控
- **资源使用**：CPU、内存、磁盘使用情况
- **缓存命中率**：缓存效果监控
- **搜索相关性评分**：搜索质量监控



#### 记录
- 50000条  ～ 600MB      耗时 ～ 3 h
- 总数：360 万 / 50000  = 72
- 索引空间  ：72 * 600MB = 约  45G  
- 总耗时： 72 * 3h = 约 216h=9d





###  B2B酒店搜索引擎体验记录
- 进入搜索页面， 没有识别或者获取当前用户的位置， 应该自动定位到用户当前城市， 方便用户搜索附近酒店或者某个地点的酒店，比如通用词搜索公园， 商圈，地铁站，商场，机场等如果知道用户大概的位置才能更好的搜索出是用户需要的。
- 搜索结果页面， 结果排序不合理， 比如搜索“北京酒店”， 结果第一页出现了很多国际酒店， 明显不符合用户预期， 应该优先展示国内酒店， 其次才是国际酒店。如果根据用户的IP地址定位到用户所在城市， 结果应该优先展示用户所在城市的酒店， 其次才是其他城市的酒店。
- 搜索匹配结果列表， 没有显示酒店的评分， 这些信息对于用户选择酒店非常重要， 应该在搜索匹配结果中展示酒店的评分， 方便用户快速筛选和比较。
- 搜索结果页面， 增加排序功能， 让用户可以根据价格，评分，距离等维度对搜索结果进行排序， 提升用户体验。
- 搜索酒店输入框， 没有提供智能提示功能， 用户输入时没有联想推荐， 这对于用户快速找到目标酒店非常不友好
- 增加酒店特色专题页排行榜，比如奢华，温泉，亲子，情侣，电竞等， 方便用户根据需求快速找到合适的酒店。
- 引入AI辅助酒店搜索，如自然语言识别理解（比如：我要找个带温泉的酒店）， 智能推荐（根据用户历史搜索和预订行为推荐酒店）
- 引入AI辅助语言识别： 目前只支持中文，英文，繁体，拼音，  尝试能不能用 AI 辅助识别 比如，日文，韩文，泰文这些
- 用户搜索的语义理解： 目前只能根据关键词匹配， 不能理解用户的搜索意图， 未来可以尝试用AI技术理解用户的搜索意图， 提供更精准的搜索结果。还可以接入：高德/Mapbox POI数据库